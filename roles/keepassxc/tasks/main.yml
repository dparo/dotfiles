- name: Install
  ansible.builtin.dnf:
    name:
      - keepassxc
    state: present
  become: true
  tags:
    - keepassxc

- name: Create config dir
  ansible.builtin.file:
    path: "{{ ansible_user_dir }}/.config/keepassxc"
    state: directory
    mode: "0755"
  tags:
    - keepassxc

- name: Setup keepassxc config - General
  community.general.ini_file:
    path: "{{ ansible_user_dir }}/.config/keepassxc/keepassxc.ini"
    section: General
    option: "{{ item.key }}"
    value: "{{ item.value }}"
    no_extra_spaces: True
  loop:
    - { key: ConfigVersion, value: 2 }
    - { key: MinimizeAfterUnlock, value: "true" }
  tags:
    - keepassxc

- name: Setup keepassxc config - Browser
  community.general.ini_file:
    path: "{{ ansible_user_dir }}/.config/keepassxc/keepassxc.ini"
    section: Browser
    option: "{{ item.key }}"
    value: "{{ item.value }}"
    no_extra_spaces: True
  loop:
    - { key: Enabled, value: "true" }
  tags:
    - keepassxc

- name: Setup keepassxc config - GUI
  community.general.ini_file:
    path: "{{ ansible_user_dir }}/.config/keepassxc/keepassxc.ini"
    section: GUI
    option: "{{ item.key }}"
    value: "{{ item.value }}"
    no_extra_spaces: True
  loop:
    - { key: ApplicationTheme, value: dark }
    - { key: MinimizeOnClose, value: "true" }
    - { key: MinimizeOnStartup, value: "false" }
    - { key: MonospaceNotes, value: "true" }
    - { key: ShowTrayIcon, value: "true" }
    - { key: TrayIconAppearance, value: monochrome-light }
  tags:
    - keepassxc
