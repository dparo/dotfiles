---
- name: Yum Repos
  tags:
    - fedora
    - yum.repos.d
    - rpmfucsion
  when: ansible_distribution == 'Fedora'
  block:
    - name: Install third party repositories
      ansible.builtin.dnf:
        name:
          - fedora-workstation-repositories

    - name: Enable the RPM Fusion repository for {{ ansible_distribution ~ ' ' ~ ansible_distribution_major_version }}
      ansible.builtin.dnf:
        name:
          - https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-{{ ansible_distribution_major_version }}.noarch.rpm
          - https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-{{ ansible_distribution_major_version }}.noarch.rpm
        state: latest
      become: true

    - name: Delete unused repositories
      ansible.builtin.file:
        path: /etc/yum.repos.d/{{ item }}
        state: absent
      become: true
      loop:
        - _copr_phracek-PyCharm.repo
        - _copr:copr.fedorainfracloud.org:phracek:PyCharm.repo
        - _copr_phracek-PyCharm.repo.rpmsave
        - rpmfusion-nonfree-nvidia-driver.repo
        - rpmfusion-nonfree-steam.repo
