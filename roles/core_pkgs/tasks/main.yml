---

- name: Install
  ansible.builtin.dnf:
    name:
      - openssl
      - nano
      - direnv
      - openssh
      - polkit
      - sqlite
      - wget
      - curl
      - rclone
      - restic # Modern backup program with support for rclone (Cloud based backups)
      - rsync
      - jq
      - rsync
      - p7zip
      - p7zip-plugins
      - unrar
      - unzip
      - atool # atool is a script for managing file archives of various types (tar,tar+gzip, zip etc)
      - make
      - automake
      - gcc
      - gcc-c++
      - kernel-devel
      - python3-pip
      - bat
      - exa
      - tree
      - fd-find
      - htop
      - btop
      - net-tools
      - lm_sensors
      - ffmpeg
      - speedtest-cli
      # - parallel # GNU Parallel is a shell tool for executing jobs in parallel
      - moreutils-parallel      # More minimal and simpler alternative to GNU parallel that doesn't polluate the namespace with stupid programs such as /usr/bin/sql
      - zbar # QR Code reader
      - qrencode # QR Code encoder
      - oathtool # A command line tool for generating and validating OTPs
      - openldap-clients
      - calc # Arbitrary precision C-like calculator
    state: present
  become: true
  tags:
    - core-pkgs

- name: Remove unwanted packages
  ansible.builtin.dnf:
    name:
      - libreoffice-core
    state: absent
    autoremove: true
  become: true
  tags:
    - core-pkgs

- name: Install sad (https://github.com/ms-jpq/sad)
  ansible.builtin.unarchive:
    src: https://github.com/ms-jpq/sad/releases/latest/download/x86_64-unknown-linux-gnu.zip
    dest: "{{ ansible_user_dir }}/.local/bin"
    remote_src: true
  tags:
    - core-pkgs
    - sad

- name: Symlink config files
  ansible.builtin.file:
    src: "{{ item }}"
    dest: "{{ ansible_user_dir }}/.config/{{ item | basename }}"
    state: link
  loop:
    - "{{ role_path }}/files/direnv"
    - "{{ role_path }}/files/bat"
    - "{{ role_path }}/files/nano"
    - "{{ role_path }}/files/readline"
    - "{{ role_path }}/files/wgetrc"
  tags:
    - core-pkgs
